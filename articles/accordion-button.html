<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>What really happens when a user clicks an accordion button? - Max Design</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="../assets/css/styles.css" rel="stylesheet">
  <meta name="description" content="We follow the path of a button that has been clicked, through the browser architecture">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  <link rel="icon" href="/favicon.ico">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,400;0,500;0,700;1,400;1,500;1,700&family=Roboto+Slab&display=swap" rel="stylesheet">
  <link rel="alternate" type="application/rss+xml" href="https://www.maxdesign.com.au/feed.xml" title="Max Design articles">
<style>
.footnote-target:focus,
.footnote-target:target,
.ref-target:focus,
.ref-target:target {
  outline: 2px dotted black;
  animation: fade 3s forwards;
}

@keyframes fade {
  0% {
    background-color: #ffff00;
    outline-color: black;
  }
  100% {
    background-color: transparent;
    outline-color: transparent;
  }
}
</style>
</head>
<body>
  <header>
    maxdesign.com.au
  </header>
  <nav aria-label="Site">
    <ul>
      <li><a href="../index.html">Home</a></li>
      <li><a href="../about/index.html">About</a></li>
      <li><a href="../resources/index.html">Resources</a></li>
      <li><a href="../talks/index.html">Presentations</a></li>
      <li><a href="../articles/index.html" class="current">Articles</a></li>
    </ul>
  </nav>
  <div class="banner-inner">
    <div class="banner-content">
      <h1>What really happens when a user clicks an accordion button?</h1>    
    </div>
  </div>  
  <main>

<p class="metadetails">Published: <time datetime="2025-12-04">4 December 2025</time></p>

<p>A quick note before we begin:</p>

<p>The “<a href="https://www.maxdesign.com.au/articles/end-to-end-event-architecture.html">End-to-end browser and accessibility event architecture</a>” article, along with the <a href="../assets/img/end-to-end-browser-accessibility-event-architecture.png" target="_blank">architectural diagram</a>, describe all the <b>systems</b> that exist inside the browser, accessibility pipeline, and assistive technologies. It’s a map of the components.</p>

<p>This article is different — it shows the <b>processes</b> that flow through those systems when a user clicks an accordion button.</p>

<p>These flows are not linear. Events jump between multiple layers (JavaScript, Web APIs, rendering, accessibility trees, OS APIs, and assistive technologies).</p>

<p>That’s simply how the architecture works: it is an intricate, concurrent set of systems that constantly talk to each other.</p>

<p>So don’t expect a neat step-by-step “path” — expect a dance that moves across different layers.</p>

<hr>

<h2>An accordion button</h2>

<p>Imagine a screen reader user encounters a button used to toggle an accordion open and closed. </p>

<p>In the closed state, the markup will be:</p>

<pre><code>&lt;button aria-label="Open accordion" <span class="highlight">aria-expanded="false"</span>&gt;
&lt;/button&gt;</code></pre>

<p>When the button is triggered, the markup will change to:</p>

<pre><code>&lt;button aria-label="Open accordion" <span class="highlight">aria-expanded="true"</span>&gt;
&lt;/button&gt;</code></pre>

<p>This is important as the button will then be announced as either “collapsed” or “expanded”.</p>

<h3>How the accordion is toggled</h3>

<p>In this example, a small piece of JavaScript is attached to the button. When the user clicks it, an <b>event handler</b> runs.</p>

<p>This code listens for the click and updates the DOM by toggling <code>aria-expanded</code> between <code>"false"</code> and <code>"true"</code>.</p>

<p>The browser will run this JavaScript later in the flow.</p>

<p>Let’s review the entire process from start to finish.</p>

<hr>

<h2>The process</h2>

<h3>1. User interacts with the button</h3>

<p>The browser begins with the HTML and ARIA shown above, which define the button’s role, name and state.</p>

<ul>
  <li>Name: Open accordion</li>
  <li>Role: button</li>
  <li>State: <code>aria-expanded="false"</code> (which screen readers announce as “collapsed”).</li>
</ul>

<p><b>The button has just been clicked!</b></p>

<p>No JavaScript runs yet — the browser simply has a semantic, labelled button, which sets the foundation for everything that follows.</p>

<h3>2. Browser computes the click target and synthesises a click event</h3>

<p>The operating system sends low-level input events — such as pointerdown, mouseup, or pointermove — to the browser.</p>

<p>The browser performs hit-testing <sup class="ref-target" id="ref-hittest"><a href="#hittest">1</a></sup> to determine which on-screen element was targeted.</p>

<p>Based on this sequence of low-level events, the browser <b>synthesises</b> a DOM <code>click</code> event so it has a standard way to represent the interaction.</p>

<p>The event object contains information such as event type, target element, coordinates, and whether the event should bubble <sup class="ref-target" id="ref-bubble"><a href="#bubble">2</a></sup>.</p>

<h3>3. The click event enters the task queue</h3>

<p>The browser does <b>not</b> run your JavaScript immediately.</p>

<p>Instead, it schedules a “dispatch click event” task <sup class="ref-target" id="ref-dispatchclickevent"><a href="#dispatchclickevent">3</a></sup> and places it into the Task Queue <sup class="ref-target" id="ref-taskqueue"><a href="#taskqueue">4</a></sup>.</p>

<p>The task will run when the JavaScript engine is idle and ready for the next piece of work.</p>

<h3>4. The event loop hands the click task to the JavaScript engine</h3>

<p>When the event loop <sup class="ref-target" id="ref-eventloop"><a href="#eventloop">5</a></sup> is ready for a new task, it selects the “dispatch click event” task and hands it to the JavaScript engine.</p>

<h3>5. The event handler runs</h3>

<p>The browser’s event dispatch algorithm determines which element should receive the event.</p>

<p>The browser then runs any event listeners on that element and its ancestors. Your event handler runs and updates the DOM — in this case, toggling <code>aria-expanded="true"</code>.</p>

<p>This DOM mutation <sup class="ref-target" id="ref-dommutation"><a href="#dommutation">6</a></sup> may cause style recalculation or layout updates.</p>

<p>When the handler finishes, JavaScript execution ends and control returns to the browser.</p>

<h3>6. Browser updates style, layout, or paint if needed</h3>

<p>The browser may update style, layout, or paint after the DOM change — either immediately or during the next rendering phase.</p>

<p>This may involve recalculating styles, updating layout, and repainting changes on screen.</p>

<p><b>Note:</b> These updates do not always happen immediately. The browser may batch, defer, or skip work depending on performance optimisations.</p>

<h3>7. Browser updates the accessibility tree</h3>

<p>The browser updates its internal AXTree (accessibility tree) to reflect the button’s new state.</p>

<p>This includes recomputing accessibility properties — such as name, role, and the updated <code>aria-expanded="true"</code> value.</p>

<p><b>Note:</b> AXTree updates can occur during or shortly after DOM and layout updates, depending on the engine’s scheduling.</p>

<h3>8. Browser fires accessibility events</h3>

<p>The accessibility subsystem determines what changed and generates one or more <b>AXEvents</b> — internal accessibility notifications such as “expanded state changed”.</p>

<p>These AXEvents are delivered through the operating system’s accessibility API.</p>

<h3>9. Events cross the OS accessibility API boundary</h3>

<p>The browser sends these <b>AXEvents</b> to the operating system’s accessibility API, such as:</p>

<ul>
  <li><b>AX API</b> on macOS and iOS</li>
  <li><b>UIA</b> on Windows</li>
  <li><b>ATK</b> and <b>AT-SPI</b> on Linux</li>
</ul>

<p>The OS accessibility API notifies assistive technologies, which may also request additional information from the browser.</p>

<h3>10. Screen reader receives events and queues utterances</h3>

<p>The screen reader receives the notification and decides what to announce based on user settings.</p>

<p>It adds the message to its internal speech queue <sup class="ref-target" id="ref-internalspeechqueue"><a href="#internalspeechqueue">7</a></sup>, which manages order, interruptions, and priority.</p>

<p>It then outputs speech or braille.</p>

<p>The user hears: <b>“Open accordion. Expanded.”</b></p>

<p>The process is now complete.</p>

<hr>

<h2>Caveats and nuances</h2>

<ul>
  <li>This explanation is a broad generalisation of how modern browsers work.</li>
  <li>The overall pattern is consistent across Blink, WebKit and Gecko, though internal details differ.</li>
  <li>Screen readers vary in how they interpret events and generate speech.</li>
  <li>Many steps happen automatically and are not visible to developers.</li>
  <li>Actual behaviour depends on browser, OS, assistive tech, and user settings.</li>
</ul>

<hr>

<h2>Footnotes</h2>
<ul>  
  <li>
    <span id="hittest" tabindex="-1" class="footnote-target">[1]</span>
    <b>Hit-testing</b>: The browser’s method for locating which on-screen element sits under the user’s tap, click, or pointer position.
    [<a href="#ref-hittest" class="back">Back</a>]
  </li>

  <li>
    <span id="bubble" tabindex="-1" class="footnote-target">[2]</span>
    <b>Bubble</b>: When a DOM event happens on an element, it “bubbles up” the page — first the element, then its parent, then its parent’s parent.
    [<a href="#ref-bubble" class="back">Back</a>]
  </li>

  <li>
    <span id="dispatchclickevent" tabindex="-1" class="footnote-target">[3]</span>
    <b>Dispatch click event task</b>: A scheduled piece of work telling the browser: “run this element’s click event when the JS engine is ready.”
    [<a href="#ref-dispatchclickevent" class="back">Back</a>]
  </li>

  <li>
    <span id="taskqueue" tabindex="-1" class="footnote-target">[4]</span>
    <b>Task Queue</b>: A queue where the browser stores tasks like user events, timers, and network callbacks until the event loop selects them.
    [<a href="#ref-taskqueue" class="back">Back</a>]
  </li>

  <li>
    <span id="eventloop" tabindex="-1" class="footnote-target">[5]</span>
    <b>Event loop</b>: The mechanism that selects and runs tasks and microtasks, and yields control to the browser between them.
    [<a href="#ref-eventloop" class="back">Back</a>]
  </li>

  <li>
    <span id="dommutation" tabindex="-1" class="footnote-target">[6]</span>
    <b>DOM mutation</b>: Any change to the DOM tree. These mutations can occur with or without JavaScript.
    [<a href="#ref-dommutation" class="back">Back</a>]
  </li>

  <li>
    <span id="internalspeechqueue" tabindex="-1" class="footnote-target">[7]</span>
    <b>Internal speech queue</b>: A screen reader’s ordered list of messages waiting to be spoken, used to manage timing and interruptions.
    [<a href="#ref-internalspeechqueue" class="back">Back</a>]
  </li>
</ul>

<script>
// Select ALL footnote links inside <sup>
document.querySelectorAll('sup a[href^="#"]').forEach(link => {
  link.addEventListener('click', e => {
    const id = link.getAttribute('href').slice(1);
    const target = document.getElementById(id);

    if (target) {
      target.setAttribute('tabindex', '-1');
      target.focus();
    }
  });
});
</script>

  </main>
  <footer>
    <ul>
      <li><a href="/sitemap.html">Sitemap</a></li>
      <li><a href="/feed.xml">Feed</a></li>
      <li><a href="/contact-us/index.html">Contact</a></li>
      <li><a href="https://github.com/russmaxdesign" target="_blank">Github</a></li>
      <li><a href="https://www.linkedin.com/in/russweakley/" target="_blank">Linkedin</a></li>
    </ul>
    <p>Copyright &copy; Max Design 2025</p>
  </footer>
</body>
</html>
